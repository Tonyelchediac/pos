<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurant POS System</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>POS System - Table 7</h1>
    <div class="alfa">
        <section>
            <h2>Menu</h2>
            <details>
                <summary class="pos-summary-details">Eating Menu</summary>
            <ul id="menu">
                <li>
                    <button class="ordermenu" onclick="addToOrder('Burger', 350)">Burger 350,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Chicken Burger', 350)">Chicken Burger 350,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Small Burger', 300)">Small Burger 300,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Burger Platter', 400)">Burger Platter 400,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Pita Bread Burger', 350)">Pita Bread Burger 350,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Tawook Pita Bread', 350)">Tawook Pita Bread 350,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Tawook Platter', 400)">Tawook Platter 400,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Tawook sub', 400)">Tawook sub 400,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Submarine', 350)">Submarine 350,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Sausages', 350)">Sausages 350,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Sujok', 350)">Sujok 350,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Fajitas', 400)">Fajitas 400,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Chiken Sub', 400)">Chiken Sub 400,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Fries Pita Bread', 200)">Fries Pita Bread 200,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Fries Platter', 400)">Fries Platter 400,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Fries Sub', 400)">Fries Sub 400,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Pizza-Burger', 800)">Pizza-Burger 800,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Vegetarian Pizza', 550)">Vegetarian Pizza 550,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Pepperoni Pizza', 550)">Pepperoni Pizza 550,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Chicken Barbecue Pizza', 650)">Chicken Barbecue Pizza 650,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Fries Sub', 400)">Fries Sub 400,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Pizza-Burger Offer', 500)">Pizza-Burger Offer 500,000</button>
                </li>
                <li>
                    <button class="ordermenu" onclick="addToOrder('Coleslaw', 150)">Coleslaw 150,000</button>
                </li>
                <li>
                    <button style="color: red;" class="ordermenu" onclick="addToOrder('Add Fies or Coleslaw', 50)">Add Fries or Coleslaw 50,000</button>
                </li>
                <li>
                    <button style="color: red;" class="ordermenu" onclick="addToOrder('Add Fries & Coleslaw', 100)">Add Fries & Coleslaw 100,000</button>
                </li>
                <li>
                    <button style="color: red;" class="ordermenu" onclick="addToOrder('Add Cheese', 50)">Add Cheese 50,000</button>
                </li>
                <li>
                    <button style="color: red;" class="ordermenu" onclick="addToOrder('Add Garlic', 20)">Add Garlic 20,000</button>
                </li>
            </ul>
        </details>
        <details>
            <summary class="pos-summary-details">Drinks</summary>
        <ul id="menu">
            <li>
                <button class="ordermenu" onclick="addToOrder('PEPSI', 50)">PEPSI 50,000</button>
            </li>
            <li>
                <button class="ordermenu" onclick="addToOrder('PEPSI DIET', 50)">PEPSI DIET 50,000</button>
            </li>
            <li>
                <button class="ordermenu" onclick="addToOrder('MIRANDA', 50)">MIRANDA 50,000</button>
            </li>
            <li>
                <button class="ordermenu" onclick="addToOrder('MIRANDA DIET', 50)">MIRANDA DIET 50,000</button>
            </li>
            <li>
                <button class="ordermenu" onclick="addToOrder('7UP', 50)">7UP 50,000</button>
            </li>
            <li>
                <button class="ordermenu" onclick="addToOrder('7UP DIET', 50)">7UP DIET 50,000</button>
            </li>
            <li>
                <button class="ordermenu" onclick="addToOrder('WATER', 30)">WATER 30,000</button>
            </li>
            <li>
                <button style="color: red;" class="ordermenu" onclick="addToOrder('Add Lemon Slice', 0)">Add Lemon SLice 000</button>
            </li>
        </ul>
    </details>

            <section  id="summaryorder">
                <h2>Discount</h2>
                <p for="discount-input">Enter Discount (%):</p>
                <input type="number" id="discount-input" placeholder="Enter discount">
                <br>
                <button class="button-k" onclick="applyDiscount()">Apply</button>
            </section>
        
            <section>
                <h2>Finish and Pay</h2>
                <br>
                <button class="button-k" onclick="finishAndPay()">Finish & Pay</button>
            </section>
            
            <section>
                <div class="calculator-container">
                    <button class="button-k" onclick="calculateTotal()">Calculate</button>
                </div>
            </section>
         </section>
         
         <section>
            <h2>Order Summary</h2>
            <br>
            <ul id="order-summary"></ul>
            <br>
            <p class="order-total">Total: LBP <span id="order-total">0</span></p>
            <p class="discounted-total">Discounted Total: <span id="discounted-total">0</span></p>
            <button class="button-k" onclick="sendOrderSummaryToWhatsApp()">Send Order to kitchen </button>
            <br>
            <a href="tables1.html"><button class="button-k">Back</button></a>
        </section>
    </div>
<!--JS----------------------------------------------------------------------------------------------------------->
    <script>
        let order = [];
        const currentPage = window.location.pathname;
    
        window.onload = function() {
            const storedOrder = localStorage.getItem(`order_${currentPage}`);
            if (storedOrder) {
                order = JSON.parse(storedOrder);
                updateOrderSummary();
            }
        };
    
        function sendOrderSummaryToWhatsApp() {
            const orderSummary = getOrderSummaryText();
            const whatsappNumber = '+96171096971';
    
            window.open(`https://api.whatsapp.com/send?phone=${whatsappNumber}&text=${encodeURIComponent(orderSummary)}`);
        }
    
        function getOrderSummaryText() {
            let summaryText = 'Order Summary - Table 7:\n\n';
    
            order.forEach((item) => {
                summaryText += `${item.item} - LBP ${item.price.toLocaleString()},000\n`;
            });
    
            const discount = getDiscountInfo();
            if (discount) {
                summaryText += `\nDiscount Applied: ${discount}%`;
            }
    
            return summaryText;
        }
    
        function getDiscountInfo() {
            const discountInput = document.getElementById('discount-input');
            const discountPercentage = parseFloat(discountInput.value);
    
            if (!isNaN(discountPercentage) && discountPercentage >= 0 && discountPercentage <= 100) {
                return discountPercentage;
            }
    
            return null;
        }
    
        function addToOrder(item, price) {
            order.push({ item, price });
            updateOrderSummary();
            saveOrderToLocalStorage();
        }
    
        function removeItem(index) {
            order.splice(index, 1);
            updateOrderSummary();
            saveOrderToLocalStorage();
        }
    
        function applyDiscount() {
            const discountInput = document.getElementById('discount-input');
            const discountPercentage = parseFloat(discountInput.value);
    
            if (isNaN(discountPercentage) || discountPercentage < 0 || discountPercentage > 100) {
                alert('Please enter a valid discount percentage (between 0 and 100).');
                return;
            }
    
            const discountAmount = (discountPercentage / 100) * getOrderTotal();
            const discountedTotal = getOrderTotal() - discountAmount;
    
            const discountedTotalElement = document.getElementById('discounted-total');
            discountedTotalElement.innerHTML = `LBP ${discountedTotal.toLocaleString('en-US', { minimumFractionDigits: 3, maximumFractionDigits: 3 })}`;
            discountedTotalElement.style.fontSize = '20px';
            discountedTotalElement.style.fontWeight = 'bold';
    
            alert(`Discount applied successfully!\nDiscount Amount: LBP ${discountAmount.toFixed(3)}\n\nDiscounted Total: LBP ${discountedTotal.toLocaleString('en-US', { minimumFractionDigits: 3, maximumFractionDigits: 3 })}`);
            saveOrderToLocalStorage();
        }
    
        function updateOrderSummary() {
            const orderSummary = document.getElementById('order-summary');
            const orderTotalElement = document.getElementById('order-total');
            let total = 0;
    
            orderSummary.innerHTML = '';
    
            order.forEach((item, index) => {
                const li = document.createElement('li');
                li.textContent = `${item.item} - LBP ${item.price.toLocaleString()},000`;
    
                const removeButton = document.createElement('button');
                removeButton.textContent = 'Remove';
                removeButton.onclick = () => removeItem(index);
    
                removeButton.style.marginLeft = '20px';
    
                li.appendChild(removeButton);
                orderSummary.appendChild(li);
                total += item.price;
            });

    
            orderTotalElement.textContent = total.toLocaleString('en-US', { minimumFractionDigits: 3, maximumFractionDigits: 3 });
            saveOrderToLocalStorage();
        }
    
        function getOrderTotal() {
            let total = 0;
            order.forEach(item => {
                total += item.price;
            });
            return total;
        }
    
        function resetOrder() {
            order = [];
            localStorage.removeItem(`order_${currentPage}`);
            const orderSummary = document.getElementById('order-summary');
            const orderTotalElement = document.getElementById('order-total');
            const discountedTotalElement = document.getElementById('discounted-total');
            const discountInput = document.getElementById('discount-input');
    
            orderSummary.innerHTML = '';
            orderTotalElement.textContent = '0.000';
            discountedTotalElement.innerHTML = 'LBP 0.000';
            discountedTotalElement.style.fontSize = '';
            discountedTotalElement.style.fontWeight = '';
            discountInput.value = '';
        }
    
        function finishAndPay() {
    const recipientNumber = prompt('Enter WhatsApp number to send the order summary (e.g., +96171096971):');

    if (!recipientNumber) {
        alert('Invalid WhatsApp number. Please enter a valid number to send the order summary.');
        return;
    }

    let orderSummary = '*Hello From TCRCS*\nThis is the Receipt for Your Order.\n Sitting on Table No.07\n\n*Order:*\n';

    order.forEach((item) => {
        orderSummary += `${item.item} - LBP ${item.price.toLocaleString()},000\n`;
    });

    orderSummary += `\nTotal: LBP ${getOrderTotal().toLocaleString('en-US', { minimumFractionDigits: 3, maximumFractionDigits: 3 })}`;

    //discount in the inoice if discount displayed 
    const discountInfo = getDiscountInfo();
    if (discountInfo) {
        orderSummary += `\nDiscount Applied: ${discountInfo}%`;
        const discountAmount = (discountInfo / 100) * getOrderTotal();
        const discountedTotal = getOrderTotal() - discountAmount;
        orderSummary += `\n*Discounted Total: LBP ${discountedTotal.toLocaleString('en-US', { minimumFractionDigits: 3, maximumFractionDigits: 3 })}*`;
    }
    //
    
    orderSummary += '\n\n----------------------\nThank You For Visiting Us\nPowered by TCRCS';

    window.open(`https://api.whatsapp.com/send?phone=${encodeURIComponent(recipientNumber)}&text=${encodeURIComponent(orderSummary)}`);
}

    
        function calculateTotal() {
            const calculateInput = prompt('Enter a number to subtract from the total:\n*Enter the number without the 000*');
            const enteredValue = parseFloat(calculateInput);
    
            if (isNaN(enteredValue)) {
                alert('Please enter a valid number.');
                return;
            }
    
            const newTotal = getOrderTotal() - enteredValue;
    
            alert(`New Total after subtraction: LBP ${newTotal.toLocaleString('en-US', { minimumFractionDigits: 3, maximumFractionDigits: 3 })}`);
            resetOrder();
            order = [];
            updateOrderSummary();
            saveOrderToLocalStorage();
            alert('Order completed and paid successfully!');
        }
    
        function saveOrderToLocalStorage() {
            localStorage.setItem(`order_${currentPage}`, JSON.stringify(order));
        }
    </script>
    

</body>
</html>
